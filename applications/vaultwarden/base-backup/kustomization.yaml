apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  #- pre-backup-cronjob.yaml
  #- backup-cronjob.yaml
  #- post-backup-cronjob.yaml
  #- backup-cronjob-v2.yaml
  - backup-sa.yaml
  - backup-role.yaml
  - backup-rolebinding.yaml
  - backup-sa-token.yaml
  
  # move to vault
  - https://gitea.tryrocket.cloud/tryrocket-cloud/vaultwarden//?ref=main

  
  - backup-cronjob-v3.yaml
  - argocd-external-secret.yaml
  
  #- hetzner-subaccount-ssh-config-external-secret.yaml TODO: enable it
  #- hetzner-subaccount-ssh-privatekey-external-secret.yaml TODO: enable it
  
  - restic-external-secret.yaml

configMapGenerator:
#  - name: argocd-config
#    envs:
#      - argocd.env
  - name: pgdump-config
    envs:
      - pgdump.env
  - name: restic-config
    envs:
      - restic.env
  - name: healthchecks-config
    envs:
      - healthchecks.env

# TODO: add git hash to backup