apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - backup-cronjob.yaml

  # Configuration for the ssh connection to the storage box
  - hetzner-subaccount-ssh-external-secret.yaml

  - healthchecks-external-secret.yaml
  - restic-external-secret.yaml
  
  - ../base/ionos-objectstorage-eu-central-1-s3-restic-external-secret.yaml
  - ionos-objectstorage-eu-central-3-s3-restic-external-secret.yaml

configMapGenerator:
  - name: pgdump-config
    literals:
      - PGHOST=postgres.postgres-16.svc.cluster.local
      - PGPORT=5432
      - PGDATABASE=vaultwarden
      - PGTZ=Europe/Berlin

  - name: restic-config
    literals:
      - RESTIC_REPOSITORY=sftp:storagebox:/home/test-backup
