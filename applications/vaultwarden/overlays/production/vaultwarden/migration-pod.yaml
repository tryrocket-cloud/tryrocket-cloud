apiVersion: v1
kind: Pod
metadata:
  name: migration-pod
spec:
  containers:
  - name: migration-pod
    image: postgres:16.3-alpine
    command:
        - /bin/sh
        - -c
        - |
          apk update && apk add --no-cache fish git curl
          sleep infinity
    volumeMounts:
      - name: vaultwarden-new-volume
        mountPath: /data-new
      - name: vaultwarden-old-volume
        mountPath: /data-old
  volumes:
    - name: vaultwarden-new-volume
      persistentVolumeClaim:
        claimName: vaultwarden-data-pvc
    - name: vaultwarden-old-volume
      persistentVolumeClaim:
        claimName: vaultwarden-rwx-pvc
